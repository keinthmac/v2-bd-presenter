"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[857],{4857:(Vt,Y,u)=>{u.r(Y),u.d(Y,{MeetingModule:()=>qt});var Z=u(4755),I=u(9223);function P(n,r,t,i,o,l,s){try{var a=n[l](s),d=a.value}catch(x){return void t(x)}a.done?r(d):Promise.resolve(d).then(i,o)}function h(n){return function(){var r=this,t=arguments;return new Promise(function(i,o){var l=n.apply(r,t);function s(d){P(l,i,o,s,a,"next",d)}function a(d){P(l,i,o,s,a,"throw",d)}s(void 0)})}}var k=u(3144),c=u(9401),W=u(7771),z=u(2340),ie=u(5439),p=u.n(ie),j=u(8675),C=u(4004),ne=u(8746),E=u(6805);function oe(n,r){const t="object"==typeof r;return new Promise((i,o)=>{let s,l=!1;n.subscribe({next:a=>{s=a,l=!0},error:o,complete:()=>{l?i(s):t?i(r.defaultValue):o(new E.K)}})})}var le=u(930);function L(n,r){const t="object"==typeof r;return new Promise((i,o)=>{const l=new le.Hp({next:s=>{i(s),l.unsubscribe()},error:o,complete:()=>{t?i(r.defaultValue):o(new E.K)}});n.subscribe(l)})}var S=u(4387),e=u(2223),V=u(3426);let re=(()=>{class n{constructor(t){this.http=t}isDownloadUrl(t){const o={headers:new k.WM({"Content-Type":"application/json",Accept:"application/json"}),observe:"response"};return this.http.get(t,o).pipe((0,C.U)(l=>{const s=l.headers.get("content-type");return this.isKnownDownloadFileType(s)}))}isKnownDownloadFileType(t){return!!t&&(t.startsWith("application/")||t.startsWith("image/")||t.startsWith("audio/")||t.startsWith("video/")||t.startsWith("application/octet-stream"))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(k.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var J=u(7433),G=u(430),b=u(5741),Q=u(6718),q=u(7961);function se(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13)(2,"div",14),e._UZ(3,"img",15),e.TgZ(4,"div",16)(5,"span",17),e._uU(6),e.qZA(),e.TgZ(7,"span",18),e._uU(8),e.qZA()()(),e._UZ(9,"div",19),e.qZA(),e.TgZ(10,"div",20)(11,"button",21),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addMedia())}),e._uU(12,"Add this media"),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("src",null==t.webFileData?null:t.webFileData.poster,e.LSH),e.xp6(3),e.Oqu(null==t.webFileData?null:t.webFileData.title),e.xp6(2),e.Oqu(null==t.webFileData?null:t.webFileData.duration)}}function ae(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",22)(1,"div",23),e._UZ(2,"mat-icon",24),e.qZA(),e.TgZ(3,"div",25)(4,"span",26),e._uU(5,"Something went wrong while validating the url."),e.qZA()(),e.TgZ(6,"div",27)(7,"button",28),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.checkUrl(o.webAddress))}),e._uU(8,"Retry"),e.qZA(),e.TgZ(9,"button",29),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.reset())}),e._uU(10,"Check another url"),e.qZA()()()}2&n&&(e.xp6(2),e.Q6J("svgIcon","heroicons_solid:exclamation-circle"))}function ue(n,r){if(1&n&&(e.TgZ(0,"div",30)(1,"div",31)(2,"span",32),e._uU(3,"Please wait while we check your URL:"),e.qZA(),e.TgZ(4,"span",33),e._uU(5),e.qZA()(),e.TgZ(6,"div",13)(7,"div",34),e._UZ(8,"div",35),e.TgZ(9,"div",36),e._UZ(10,"div",37)(11,"div",38)(12,"div",39)(13,"div",40),e.qZA()(),e._UZ(14,"div",19),e.qZA()()),2&n){const t=e.oxw();e.xp6(5),e.Oqu(t.webAddress)}}function ce(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.webAddress=null)}),e._UZ(1,"mat-icon",50),e.qZA()}2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x-circle"))}function de(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.pasteFromClipboard())}),e._UZ(1,"mat-icon",50),e.qZA()}2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:document-text"))}function me(n,r){1&n&&(e.TgZ(0,"span",51),e._uU(1,"*Invalid URL"),e.qZA())}function pe(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"Check Url"),e.qZA())}function ge(n,r){1&n&&e._UZ(0,"mat-progress-spinner",52),2&n&&e.Q6J("diameter",20)("mode","indeterminate")}function fe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",41)(1,"mat-form-field",42)(2,"mat-label"),e._uU(3,"Web URL"),e.qZA(),e.TgZ(4,"input",43),e.NdJ("ngModelChange",function(o){e.CHM(t);const l=e.oxw();return e.KtG(l.webAddress=o)}),e.qZA(),e.YNc(5,ce,2,1,"button",44),e.YNc(6,de,2,1,"button",44),e.TgZ(7,"mat-hint"),e._uU(8,"Example: https://www.jw.org/tl/library/video/"),e.qZA()(),e.YNc(9,me,2,0,"span",45),e.TgZ(10,"button",46),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.checkUrl(o.webAddress))}),e.YNc(11,pe,2,0,"span",47),e.YNc(12,ge,1,2,"mat-progress-spinner",48),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.webAddress),e.xp6(1),e.Q6J("ngIf",t.webAddress),e.xp6(1),e.Q6J("ngIf",!t.webAddress),e.xp6(3),e.Q6J("ngIf",!t.isValidUrl(t.webAddress)&&t.webAddress),e.xp6(1),e.Q6J("disabled",!t.webAddress||t.checkingUrl||!t.isValidUrl(t.webAddress)),e.xp6(1),e.Q6J("ngIf",!t.checkingUrl),e.xp6(1),e.Q6J("ngIf",t.checkingUrl)}}let _e=(()=>{class n{constructor(t,i,o,l,s){this.matDialogRef=t,this.data=i,this.meetingService=o,this.urlFetchService=l,this.http=s,this.checkingUrl=!1,this.urlError=!1,this.checkingFinished=!1,this.hasValidUrlInClipboard=!1}close(){this.matDialogRef.close()}ngOnInit(){navigator.clipboard.readText().then(t=>{!this.webAddress&&this.isValidUrl(t)&&this.pasteFromClipboard()})}checkUrl(t){var i=this;return h(function*(){i.checkingUrl=!0,i.checkingFinished=!1,i.urlError=!1,i.meetingService.GetVideoInfoFromUrl(t).subscribe(l=>{console.log(l),i.urlError=!1,i.webFileData=l,i.checkingUrl=!1,i.checkingFinished=!0},l=>{i.checkingFinished=!0,i.urlError=!0,i.webFileData=null,i.checkingUrl=!1})})()}pasteFromClipboard(){navigator.clipboard.readText().then(t=>{this.webAddress||(this.webAddress=t)})}reset(){this.checkingUrl=!1,this.checkingFinished=!1,this.urlError=!1,this.webFileData=null,this.webAddress=null}isValidUrl(t){try{return new URL(t),!0}catch{return!1}}addMedia(){this.matDialogRef.close(this.webFileData)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(S.hV),e.Y36(S.eJ),e.Y36(V.D),e.Y36(re),e.Y36(k.eN))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-upload-file-from-dialog"]],decls:13,vars:7,consts:[[1,"flex","flex-col","max-w-250","-m-6","w-250"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-4","sm:pl-6","bg-gray-800","text-white"],[1,"flex","flex-row"],[1,"text-white","mr-2",3,"svgIcon"],[1,"text-lg"],["mat-icon-button","",3,"tabIndex","click"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","min-w-[400px]","p-4","bg-white-300"],["class","mb-4 mt-2 w-full flex flex-col",4,"ngIf"],["class","flex flex-col w-full rounded-xl border-[1px] border-gray-400 justify-center mb-4 p-4",4,"ngIf"],["class","mb-4 w-full flex flex-col",4,"ngIf"],["class","flex flex-col",4,"ngIf"],[1,"mb-4","mt-2","w-full","flex","flex-col"],[1,"flex","flex-row","justify-between","shadow-lg","rounded-l-xl","max-h-[125px]"],[1,"flex","flex-row","justify-between"],[1,"rounded-[8px]","w-[140px]","h-[100px]",3,"src"],[1,"flex","flex-col","p-2","justify-between","h-full","w-[220px]"],[1,"text-md","font-bold","line-clamp-3"],[1,"text-sm","font-medium","text-gray-500"],[1,"w-[8px]","bg-cyan-700","justify-end"],[1,"flex","flex-col","justify-center","mt-4","w-full"],["mat-button","",1,"bg-cyan-700","text-white","hover:bg-cyan-500",3,"click"],[1,"flex","flex-col","w-full","rounded-xl","border-[1px]","border-gray-400","justify-center","mb-4","p-4"],[1,"flex","flex-row","justify-center"],[1,"text-red-500","icon-size-[30px]",3,"svgIcon"],[1,"flex","flex-row","justify-center","break-words"],[1,"text-sm","text-red-500"],[1,"flex","flex-row","justify-between","break-words","mt-2"],["mat-button","",1,"bg-red-400","bg-opacity-10",3,"click"],["mat-button","",1,"",3,"click"],[1,"mb-4","w-full","flex","flex-col"],[1,"flex","flex-col","p-4"],[1,"text-lg","font-medium","text-gray-500","text-center"],[1,"text-sm","text-blue-500","text-center","break-words"],[1,"flex","flex-row","justify-between","animate-pulse"],[1,"rounded-[8px]","w-[140px]","h-[100px]","bg-gray-300"],[1,"flex","flex-col","p-2"],[1,"w-[175px]","bg-gray-300","rounded-full","h-[8px]"],[1,"w-[150px]","bg-gray-300","rounded-full","h-[8px]","mt-[8px]"],[1,"w-[120px]","bg-gray-300","rounded-full","h-[8px]","mt-[8px]"],[1,"mt-6","w-[50px]","bg-gray-300","rounded-full","h-[8px]"],[1,"flex","flex-col"],["appearance","outline"],["matInput","","placeholder","https://...",1,"text-lg",3,"ngModel","ngModelChange"],["mat-icon-button","","type","button","matSuffix","",3,"click",4,"ngIf"],["class","text-red-400 text-sm font-medium ml-2 -mt-[2px]",4,"ngIf"],["mat-flat-button","",1,"mt-4","bg-purple-700","disabled:bg-gray-200","disabled:text-black-500","text-white","p-4",3,"disabled","click"],[4,"ngIf"],[3,"diameter","mode",4,"ngIf"],["mat-icon-button","","type","button","matSuffix","",3,"click"],[1,"icon-size-6",3,"svgIcon"],[1,"text-red-400","text-sm","font-medium","ml-2","-mt-[2px]"],[3,"diameter","mode"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"mat-icon",3),e.TgZ(4,"span",4),e._uU(5,"Upload media from Web URL"),e.qZA()(),e.TgZ(6,"button",5),e.NdJ("click",function(){return i.close()}),e._UZ(7,"mat-icon",6),e.qZA()(),e.TgZ(8,"div",7),e.YNc(9,se,13,3,"div",8),e.YNc(10,ae,11,1,"div",9),e.YNc(11,ue,15,1,"div",10),e.YNc(12,fe,13,7,"div",11),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("svgIcon","heroicons_outline:globe-alt"),e.xp6(3),e.Q6J("tabIndex",-1),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:x"),e.xp6(2),e.Q6J("ngIf",i.webFileData&&!i.checkingUrl),e.xp6(1),e.Q6J("ngIf",i.checkingFinished&&i.urlError),e.xp6(1),e.Q6J("ngIf",i.checkingUrl),e.xp6(1),e.Q6J("ngIf",!i.checkingFinished&&!i.checkingUrl))},dependencies:[Z.O5,J.eB,G.Hw,c.Fj,c.JJ,c.On,b.v_,b.pH,b.$V,b.nX,Q.k0,q.sN]}),n})();var B=u(3630),N=u(5775),R=u(6699),D=u(9570),he=u(5674),xe=u(2494),T=u(332),y=u(8280),H=u(1644),O=u(7662);let ve=(()=>{class n{constructor(){this.units=["B","KB","MB","GB","TB"]}transform(t,i=2){if(isNaN(parseFloat(String(t)))||!isFinite(t))return"-";let o=0;for(;t>=1024&&o<this.units.length-1;)t/=1024,o++;return t.toFixed(i)+" "+this.units[o]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"fileSize",type:n,pure:!0}),n})();const be=["meetingStepper"];function we(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",56)(1,"div",57)(2,"span",58),e._uU(3,"Congrats "),e.TgZ(4,"span",6),e._uU(5),e.qZA(),e._uU(6,"!"),e.qZA()(),e.TgZ(7,"span",59),e._uU(8,"We have successfully submitted your media upload!"),e.qZA(),e._UZ(9,"mat-icon",60),e.TgZ(10,"span",61),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.backToForms())}),e._uU(11,"Go Back"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(5),e.Oqu(null==t.userData?null:t.userData.nickname),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:badge-check")}}function Fe(n,r){if(1&n&&(e.TgZ(0,"fuse-alert",62),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("appearance","outline")("showIcon",!1)("type",t.alert.type)("@shake","error"===t.alert.type),e.xp6(1),e.hij(" ",t.alert.message," ")}}function ke(n,r){1&n&&e._uU(0,"Meeting Information")}function Ze(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",63),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t.weekNum),e.xp6(1),e.hij(" ",t.weekName," ")}}function Te(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",64),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openUploadFromWebUrl())}),e._uU(1,"Launch web url"),e.qZA()}}function Ce(n,r){1&n&&(e.TgZ(0,"span",67),e._uU(1,"Next"),e.qZA())}function Me(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ce,2,0,"span",65),e.TgZ(2,"span",66),e._uU(3,"Next"),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(""==(t.firstFormGroup.get("weekNumber").value||"")||""==(t.firstFormGroup.get("isMidweek").value||"")))}}function Ue(n,r){if(1&n&&(e.TgZ(0,"div",27)(1,"div",68)(2,"span",69),e._uU(3),e.qZA(),e._UZ(4,"mat-progress-spinner",70),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(t.meetingCheckString),e.xp6(1),e.Q6J("diameter",24)("mode","indeterminate")}}function Se(n,r){1&n&&e._uU(0,"Public Talk Information")}function Ne(n,r){1&n&&e._UZ(0,"mat-divider")}function ye(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",63),e._uU(2),e.qZA(),e.YNc(3,Ne,1,0,"mat-divider",29),e.BQk()),2&n){const t=r.$implicit,i=r.index;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",null==t?null:t.name," "),e.xp6(1),e.Q6J("ngIf",0==i)}}function Ae(n,r){1&n&&e._UZ(0,"mat-divider")}function Ie(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",88),e._uU(2),e.qZA(),e.YNc(3,Ae,1,0,"mat-divider",29),e.BQk()),2&n){const t=r.$implicit,i=r.index,o=e.oxw(2);e.xp6(1),e.Q6J("value",t)("ngClass",o.outlineColorCoding(t)),e.xp6(1),e.hij(" ",null==t?null:t.title," "),e.xp6(1),e.Q6J("ngIf",0==i)}}function Je(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.deletePTEntry())}),e._uU(1,"Delete Entry"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("color","warn")("disabled",t.isSubmitting)}}function Ge(n,r){1&n&&(e.TgZ(0,"span",67),e._uU(1,"Next"),e.qZA())}function Qe(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ge,2,0,"span",65),e.TgZ(2,"span",66),e._uU(3,"Next"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.secondFormGroup.get("outlineNo").valid)}}function qe(n,r){if(1&n&&(e.TgZ(0,"div",27)(1,"div",68)(2,"span",69),e._uU(3),e.qZA(),e._UZ(4,"mat-progress-spinner",70),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Oqu(t.outlineMediaCheckString),e.xp6(1),e.Q6J("diameter",24)("mode","indeterminate")}}const K=function(n){return{"disabled:bg-transparent disabled:text-white":n}};function De(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-step",12)(1,"form",13),e.YNc(2,Se,1,0,"ng-template",14),e.TgZ(3,"mat-form-field",71)(4,"mat-label"),e._uU(5,"Talk Date"),e.qZA(),e.TgZ(6,"input",72),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(9);return e.KtG(o.open())}),e.qZA(),e._UZ(7,"mat-datepicker-toggle",73)(8,"mat-datepicker",74,75),e.TgZ(10,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.secondFormGroup.get("talkDate").setValue(null))}),e._UZ(11,"mat-icon",19),e.qZA(),e.TgZ(12,"mat-error"),e._uU(13," Talk date is required. "),e.qZA()(),e.TgZ(14,"mat-form-field",15)(15,"mat-label"),e._uU(16,"Speaker's Congregation"),e.qZA(),e._UZ(17,"input",76),e.TgZ(18,"mat-autocomplete",77,78),e.NdJ("optionSelected",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.canSelectCongregation=!1)})("closed",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.congregationSelectionClosed())}),e.TgZ(20,"mat-option",79),e._uU(21,"N/A"),e.qZA(),e._UZ(22,"mat-divider"),e.YNc(23,ye,4,3,"ng-container",17),e.ALo(24,"async"),e.qZA(),e.TgZ(25,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.secondFormGroup.get("congregation").setValue(""),e.KtG(o.canSelectCongregation=!0)}),e._UZ(26,"mat-icon",19),e.qZA(),e.TgZ(27,"mat-error"),e._uU(28," Congregation is required. "),e.qZA()(),e.TgZ(29,"mat-form-field",71)(30,"mat-label"),e._uU(31,"Speaker Name"),e.qZA(),e._UZ(32,"input",80),e.TgZ(33,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.secondFormGroup.get("speakerName").setValue(null))}),e._UZ(34,"mat-icon",19),e.qZA(),e.TgZ(35,"mat-error"),e._uU(36," Speaker name is required. "),e.qZA()(),e.TgZ(37,"mat-form-field",15)(38,"mat-label"),e._uU(39,"Outline"),e.qZA(),e._UZ(40,"input",81),e.TgZ(41,"mat-autocomplete",77,82),e.NdJ("optionSelected",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.canSelectOutline=!1)})("closed",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.outlineSelectionClosed())}),e.YNc(43,Ie,4,4,"ng-container",17),e.ALo(44,"async"),e.qZA(),e.TgZ(45,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return o.secondFormGroup.get("outlineNo").setValue(""),e.KtG(o.canSelectOutline=!0)}),e._UZ(46,"mat-icon",19),e.qZA(),e.TgZ(47,"mat-error"),e._uU(48," Outline is required. "),e.qZA()(),e.TgZ(49,"mat-form-field",15)(50,"mat-label"),e._uU(51,"PT Song No."),e.qZA(),e._UZ(52,"input",83),e.TgZ(53,"button",18),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.secondFormGroup.get("songNo").setValue(""))}),e._UZ(54,"mat-icon",19),e.qZA(),e.TgZ(55,"mat-error"),e._uU(56," Song number is required. "),e.qZA()(),e.TgZ(57,"div",84)(58,"div",85),e.YNc(59,Je,2,2,"button",86),e.qZA(),e.TgZ(60,"div",26)(61,"button",53),e._uU(62,"Back"),e.qZA(),e.TgZ(63,"button",87),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.checkMeetingMedia())}),e.YNc(64,Qe,4,1,"div",29),e.YNc(65,qe,5,3,"div",30),e.qZA()()()()()}if(2&n){const t=e.MAs(9),i=e.MAs(19),o=e.MAs(42),l=e.oxw();e.Q6J("stepControl",l.secondFormGroup)("completed",l.stepperStatus.publicTalkCompleted)("editable",l.overAllStepperStatus.editable),e.xp6(1),e.Q6J("formGroup",l.secondFormGroup),e.xp6(5),e.Q6J("max",l.maxTalkDate)("min",l.minTalkDate)("matDatepicker",t),e.xp6(1),e.Q6J("for",t),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:x-circle"),e.xp6(6),e.Q6J("readonly",!l.canSelectCongregation)("matAutocomplete",i),e.xp6(1),e.Q6J("displayWith",l.displayCongFn),e.xp6(5),e.Q6J("ngForOf",e.lcZ(24,29,l.filteredCongregations)),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:x-circle"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:x-circle"),e.xp6(6),e.Q6J("readonly",!l.canSelectOutline)("matAutocomplete",o),e.xp6(1),e.Q6J("displayWith",l.displayOutlineFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(44,31,l.filteredOutlines)),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:x-circle"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:x-circle"),e.xp6(5),e.Q6J("ngIf",l.isPTEdit),e.xp6(2),e.Q6J("color","warn")("disabled",l.isSubmitting),e.xp6(2),e.Q6J("disabled",!l.secondFormGroup.valid||l.isOutlineMediaChecking)("ngClass",e.VKq(33,K,l.isOutlineMediaChecking))("color","primary"),e.xp6(1),e.Q6J("ngIf",!l.isOutlineMediaChecking),e.xp6(1),e.Q6J("ngIf",l.isOutlineMediaChecking)}}function Oe(n,r){1&n&&e._uU(0,"Media Upload")}function Ye(n,r){1&n&&(e.TgZ(0,"div",89)(1,"span",90)(2,"strong",91),e._uU(3,"Please note:"),e.qZA(),e._uU(4," The following multimedia were loaded based on the selected outline from S-34, these multimedia will not be saved unless you continue and submit."),e.qZA(),e.TgZ(5,"span",92),e._uU(6,"*You can still remove or add more media."),e.qZA()())}function Pe(n,r){if(1&n&&(e.TgZ(0,"div")(1,"div",93)(2,"span",94),e._uU(3),e.qZA()()()),2&n){const t=e.oxw();e.xp6(3),e.hij("Files: ",t.cleanse(t.selectedFiles).length,"")}}const We=function(n,r){return{"bg-green-400":n,"bg-red-400":r}};function ze(n,r){if(1&n&&(e.TgZ(0,"div",95)(1,"div",96)(2,"span",97),e._uU(3),e.ALo(4,"fileSize"),e.qZA()()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(4,We,!t.totalFilesLimitReached,t.totalFilesLimitReached)),e.xp6(2),e.Oqu(e.lcZ(4,2,t.totalFilesSize))}}function je(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",98)(2,"div",99),e._UZ(3,"img",100),e.qZA(),e.TgZ(4,"div",101)(5,"div",102)(6,"button",64),e.NdJ("click",function(){const l=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.removeFile(l))}),e._UZ(7,"mat-icon",103),e.qZA()()()(),e.BQk()}if(2&n){const t=r.$implicit;e.xp6(3),e.Q6J("src",t.url,e.LSH),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:trash")}}function Ee(n,r){if(1&n&&(e.TgZ(0,"div",104)(1,"div",27)(2,"span",105),e._uU(3,"Click this "),e.TgZ(4,"span",106),e._uU(5,"Add File(s)"),e.qZA(),e._uU(6," button to import your media."),e.qZA(),e.TgZ(7,"span",107),e._uU(8,"Please note: Maximum total size limit per upload is "),e.TgZ(9,"strong",108),e._uU(10),e.ALo(11,"fileSize"),e.qZA(),e._uU(12,"."),e.qZA()()()),2&n){const t=e.oxw(),i=e.MAs(56);e.xp6(4),e.Q6J("matMenuTriggerFor",i),e.xp6(6),e.Oqu(e.lcZ(11,2,t.totalFilesLimit))}}function Le(n,r){1&n&&(e.TgZ(0,"div",109)(1,"span",110),e._uU(2,"You have reached the maximum allowed upload limit. Please remove some of the files to continue."),e.qZA()())}const Ve=function(n,r){return{"bg-blue-700 hover:bg-blue-500 hover:shadow-xl":n,"bg-gray-400 text-black":r}};function Be(n,r){if(1&n&&(e.TgZ(0,"div",104)(1,"button",111)(2,"span",112),e._uU(3,"Add more file(s)"),e.qZA()()()),2&n){const t=e.oxw(),i=e.MAs(56);e.xp6(1),e.Q6J("disabled",t.totalFilesLimitReached)("ngClass",e.WLB(3,Ve,!t.totalFilesLimitReached,t.totalFilesLimitReached))("matMenuTriggerFor",i)}}function Re(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",113)(1,"div",114),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.removeAllFiles(!0))}),e.TgZ(2,"span",115),e._uU(3,"Remove all files"),e.qZA()()()}}function He(n,r){if(1&n&&(e.TgZ(0,"span",67),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.cleanse(t.selectedFiles).length<=0?"Skip":"Next")}}function Ke(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,He,2,1,"span",65),e.TgZ(2,"span",66),e._uU(3),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.submitFormGroup.invalid),e.xp6(2),e.Oqu(t.cleanse(t.selectedFiles).length<=0?"Skip":"Next")}}function $e(n,r){1&n&&(e.TgZ(0,"span",67),e._uU(1,"Next"),e.qZA())}function Xe(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,$e,2,0,"span",65),e.TgZ(2,"span",66),e._uU(3,"Next"),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.submitFormGroup.invalid&&"true"==t.isMidWeek&&t.selectedFiles.length>0)}}function et(n,r){1&n&&e._uU(0,"Media Arrangement")}function tt(n,r){if(1&n&&(e.TgZ(0,"span",125),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.AsE("You will be selecting the image for order number : ",t.currentOrder+1,"/",t.cleanse(t.selectedFiles).length,"")}}function it(n,r){1&n&&(e.TgZ(0,"span",125),e._uU(1,"You can modify the order of media by clicking the 'Clear Order' button below."),e.qZA())}function nt(n,r){if(1&n&&(e.TgZ(0,"div",128)(1,"div",21)(2,"span",129),e._uU(3),e.qZA()()()),2&n){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.order)}}const ot=function(n){return{"bg-black/[0.4]":n}};function lt(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",98)(2,"div",99),e._UZ(3,"img",100),e.qZA(),e.TgZ(4,"div",126),e.NdJ("click",function(){const l=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.setFileOrder(l))}),e.YNc(5,nt,4,1,"div",127),e.qZA()(),e.BQk()}if(2&n){const t=r.$implicit;e.xp6(3),e.Q6J("src",t.url,e.LSH),e.xp6(1),e.Q6J("ngClass",e.VKq(3,ot,null!=t.order)),e.xp6(1),e.Q6J("ngIf",null!=t.order)}}function rt(n,r){1&n&&(e.TgZ(0,"span",67),e._uU(1,"Next"),e.qZA())}function st(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-step",116),e.YNc(1,et,1,0,"ng-template",14),e.TgZ(2,"div",117)(3,"div",118)(4,"span",119),e._uU(5,"Please click on the image tile base on the order of projection."),e.qZA(),e.YNc(6,tt,2,2,"span",120),e.YNc(7,it,2,0,"span",120),e.TgZ(8,"div",21)(9,"button",121),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.removeOrdering())}),e.TgZ(10,"span",122),e._uU(11,"Clear Order"),e.qZA()()()(),e.TgZ(12,"div",123),e.YNc(13,lt,6,5,"ng-container",17),e.qZA()(),e.TgZ(14,"div",45)(15,"button",46),e._uU(16,"Back"),e.qZA(),e.TgZ(17,"button",124),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.sortBy("order"))}),e.TgZ(18,"div"),e.YNc(19,rt,2,0,"span",65),e.TgZ(20,"span",66),e._uU(21,"Next"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.Q6J("stepControl",t.mediaArrangmentFormGroup)("completed",t.stepperStatus.mediaArrangementCompleted)("editable",t.overAllStepperStatus.editable),e.xp6(6),e.Q6J("ngIf",t.currentOrder!=t.cleanse(t.selectedFiles).length),e.xp6(1),e.Q6J("ngIf",t.currentOrder==t.cleanse(t.selectedFiles).length),e.xp6(2),e.Q6J("color","warn"),e.xp6(4),e.Q6J("ngForOf",t.cleanse(t.selectedFiles)),e.xp6(2),e.Q6J("color","warn"),e.xp6(2),e.Q6J("color","primary")("disabled",t.currentOrder!=t.cleanse(t.selectedFiles).length),e.xp6(2),e.Q6J("ngIf",t.currentOrder==t.cleanse(t.selectedFiles).length)}}function at(n,r){1&n&&e._uU(0,"Done")}function ut(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"span",130),e._uU(2,"You are all set "),e.TgZ(3,"span",6),e._uU(4),e.qZA(),e._uU(5,"!"),e.qZA(),e.TgZ(6,"span",131),e._uU(7,"You can still review your upload before you submit by clicking the "),e.TgZ(8,"strong",132),e._uU(9,"Back"),e.qZA(),e._uU(10," button, or if you are sure about it, you can hit "),e.TgZ(11,"strong",133),e._uU(12,"Submit"),e.qZA(),e._uU(13,"."),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(null==t.userData?null:t.userData.nickname)}}function ct(n,r){1&n&&(e.TgZ(0,"span",139),e._uU(1,"We are now saving your files to our server."),e.qZA())}function dt(n,r){if(1&n&&e._UZ(0,"mat-progress-bar",140),2&n){const t=e.oxw(2);e.Q6J("value",t.uploadProgress)("mode","determinate")}}function mt(n,r){1&n&&e._UZ(0,"mat-progress-bar",141),2&n&&e.Q6J("mode","indeterminate")}function pt(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"span",130),e._uU(2,"Hang on there "),e.TgZ(3,"span",6),e._uU(4),e.qZA(),e._uU(5,"."),e.qZA(),e.TgZ(6,"span",131),e._uU(7,"Please wait while we submit your media."),e.qZA(),e.TgZ(8,"span",134)(9,"span",135),e._uU(10,"DO NOT"),e.qZA(),e._uU(11," refresh or close this browser, or even switch to other app until we finish everything."),e.qZA(),e.YNc(12,ct,2,0,"span",136),e.YNc(13,dt,1,2,"mat-progress-bar",137),e.YNc(14,mt,1,1,"mat-progress-bar",138),e.BQk()),2&n){const t=e.oxw();e.xp6(4),e.Oqu(null==t.userData?null:t.userData.nickname),e.xp6(8),e.Q6J("ngIf",t.savinginProgress),e.xp6(1),e.Q6J("ngIf",!t.savinginProgress),e.xp6(1),e.Q6J("ngIf",t.savinginProgress)}}function gt(n,r){if(1&n&&e._UZ(0,"mat-progress-bar",158),2&n){const t=e.oxw().$implicit;e.Q6J("value",null==t?null:t.uploadProgress)("mode",(null==t?null:t.uploadProgress)>=100?"indeterminate":"determinate")}}function ft(n,r){1&n&&(e.ynx(0),e.TgZ(1,"div",159),e._UZ(2,"mat-progress-spinner",70),e.TgZ(3,"span",160),e._uU(4,"Saving your file..."),e.qZA()(),e.BQk()),2&n&&(e.xp6(2),e.Q6J("diameter",16)("mode","indeterminate"))}function _t(n,r){1&n&&(e.TgZ(0,"div",159),e._UZ(1,"mat-icon",162),e.TgZ(2,"span",160),e._uU(3,"Sucessfully saved."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check-circle"))}function ht(n,r){1&n&&(e.TgZ(0,"div",159),e._UZ(1,"mat-icon",163),e.TgZ(2,"span",160),e._uU(3,"Error while saving the file."),e.qZA()()),2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:exclamation-circle"))}function xt(n,r){if(1&n&&(e.ynx(0),e.YNc(1,_t,4,1,"div",161),e.YNc(2,ht,4,1,"div",161),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",!(null!=t&&t.isError)),e.xp6(1),e.Q6J("ngIf",null==t?null:t.isError)}}const vt=function(n,r){return{"bg-blue-700":n,"bg-green-700":r}};function bt(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",145)(2,"div",146)(3,"div",147),e._UZ(4,"div",148),e.TgZ(5,"div",149)(6,"div",27),e._UZ(7,"img",150),e.qZA()(),e.TgZ(8,"div",151)(9,"div",152)(10,"div",153)(11,"span",154),e._uU(12),e.qZA(),e.TgZ(13,"span",155),e._uU(14),e.ALo(15,"fileSize"),e.qZA()()(),e.TgZ(16,"div",156),e.YNc(17,gt,1,2,"mat-progress-bar",157),e.YNc(18,ft,5,2,"ng-container",29),e.YNc(19,xt,3,2,"ng-container",29),e.qZA()()()()(),e.BQk()),2&n){const t=r.$implicit;e.xp6(4),e.Q6J("ngClass",e.WLB(9,vt,!(null!=t&&t.isSaved),null==t?null:t.isSaved)),e.xp6(3),e.Q6J("src",t.url,e.LSH),e.xp6(5),e.Oqu(null==t?null:t.name),e.xp6(2),e.Oqu(e.lcZ(15,7,null==t?null:t.size)),e.xp6(3),e.Q6J("ngIf",(null==t?null:t.uploadProgress)<100),e.xp6(1),e.Q6J("ngIf",!(null!=t&&t.isSaved)&&(null==t?null:t.uploadProgress)>=100),e.xp6(1),e.Q6J("ngIf",null==t?null:t.isSaved)}}function wt(n,r){if(1&n&&(e.TgZ(0,"div",142)(1,"span",143),e._uU(2,"Your new files(s) below along with the updates you made will be submitted."),e.qZA(),e.TgZ(3,"div",144),e.YNc(4,bt,20,12,"ng-container",17),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.Udp("width",t.getWindowWidth()),e.xp6(1),e.Q6J("ngForOf",t.showNewFiles(t.selectedFiles))}}function Ft(n,r){1&n&&(e.TgZ(0,"div")(1,"span",67),e._uU(2,"Submit"),e.qZA(),e.TgZ(3,"span",66),e._uU(4,"Submit"),e.qZA()())}function kt(n,r){1&n&&e._UZ(0,"mat-progress-spinner",70),2&n&&e.Q6J("diameter",24)("mode","indeterminate")}let Zt=(()=>{class n{onWindowResize(t){this.windowWidth=t.target.innerWidth}constructor(t,i,o,l){this._activatedRoute=t,this._matDialog=i,this._meetingService=o,this._formBuilder=l,this.env=z.N,this.alert={type:"success",message:""},this.windowWidth=window.innerWidth,this.showAlert=!1,this.isLinear=!1,this.isSubmitting=!1,this.showStepper=!0,this.isPTEdit=!1,this.isPTDeleted=!1,this.isOutlineMediaLoaded=!1,this.stepperStatus={meetingInfoCompleted:!1,meetingInfoEditable:!1,publicTalkCompleted:!1,publicTalkEditable:!1,mediaUploadCompleted:!1,mediaUploadEditable:!1,mediaArrangementCompleted:!1,mediaArrangementEditable:!1},this.overAllStepperStatus={editable:!0,completed:!0},this.selectedFiles=[],this.meetingPulledMedia=[],this.currentOrder=0,this.weekSelection=[],this.outlineSelection=[],this.canSelectOutline=!0,this.congregationSelection=[],this.canSelectCongregation=!0,this.isMidWeek="",this.isMeetingInformationChecking=!1,this.isOutlineMediaChecking=!1,this.isThumbnailLoading=!1,this.uploadProgress=0,this.savinginProgress=!1,this.totalFilesSize=0,this.totalFilesSizeString="0B",this.totalFilesLimit=1073741824,this.totalFilesLimitReached=!1,this.meetingCheckString="Checking meeting information...",this.outlineMediaCheckString="Loading outline multimedia..."}ngOnInit(){this._activatedRoute.data.subscribe(t=>{this.userData=t?.UserData?.userInfo,this.weekSelection=t?.UserData?.userInfo.weeks,this.outlineSelection=t?.UserData?.userInfo.outlines.map(l=>({outlineNo:l?.outlineNo,title:l?.outlineNo+". "+l?.title,lastUsed:l?.details[0]?.talkDate}));const i=[...this.outlineSelection.slice(0,0),{outlineNo:0,title:"No outline available",lastUsed:null},...this.outlineSelection.slice(0)];this.outlineSelection=i;let o=t?.UserData?.userInfo.depots?.filter(l=>l._id!=t?.UserData?.userInfo?.depot?._id);o=o.map(l=>({congId:l?._id,name:l?.city+" "+l?.language+" "+l?.name})),o=[...o.slice(0,0),{congId:t?.UserData?.userInfo?.depot?._id,name:"My Congregation ("+t?.UserData?.userInfo?.depot?.name+")"},...o.slice(0)],this.congregationSelection=o}),this.firstFormGroup=this._formBuilder.group({weekNumber:[null,c.kI.compose([c.kI.required])],isMidweek:[null,c.kI.compose([c.kI.required])],valid:[null,c.kI.compose([c.kI.required])]}),this.secondFormGroup=this._formBuilder.group({talkDate:["",c.kI.compose([c.kI.required])],outlineNo:[null,c.kI.compose([c.kI.required])],congregation:[null],speakerName:[null,c.kI.compose([c.kI.required])],songNo:["",c.kI.compose([c.kI.required,c.kI.min(1)])]}),this.mediaArrangmentFormGroup=this._formBuilder.group({valid:[null,c.kI.compose([c.kI.required])]}),this.submitFormGroup=this._formBuilder.group({valid:["true",c.kI.compose([c.kI.required])]}),this.filteredOutlines=this.secondFormGroup.get("outlineNo").valueChanges.pipe((0,j.O)(""),(0,C.U)(t=>{const i="string"==typeof t?t:t?.title;return i?this._filterOutlines(i):this.outlineSelection.slice()})),this.filteredCongregations=this.secondFormGroup.get("congregation").valueChanges.pipe((0,j.O)(""),(0,C.U)(t=>{const i="string"==typeof t?t:t?.name;return i?this._filterCongregations(i):this.congregationSelection.slice()}))}passwordChange(){var t=this.secondFormGroup.get("password").value,i=this.secondFormGroup.get("confirmPassword").value;this.secondFormGroup.controls.confirmPassword.setErrors(t!=i?{invalid:!0}:null)}meetingWeekChanged(){this.firstFormGroup.get("valid").setValue(null)}submitSetup(){this.showAlert=!1,this.isSubmitting=!0,this.firstFormGroup.disable(),this.secondFormGroup.disable(),this.mediaArrangmentFormGroup.disable(),this.submitFormGroup.disable();let t=this.selectedFiles.filter(a=>null!=a.name).map(a=>({filename:a.name,orderNo:a.order,remarks:null,isNew:!0}));const i=new FormData;this.selectedFiles.forEach(a=>{i.append("files",a.file)});const o=this.weekSelection.find(a=>a.weekNum==this.firstFormGroup.get("weekNumber").value).yearNumber;if(i.append("weekNumber",this.firstFormGroup.get("weekNumber").value),i.append("yearNumber",o),t.length>0&&i.append("fileProperties",JSON.stringify(t)),i.append("isMidWeek",this.isMidWeek),"true"!==this.isMidWeek){if(this.secondFormGroup.get("talkDate").value){const a=p().utc(this.secondFormGroup.get("talkDate").value).toString();i.append("talkDate",a)}this.secondFormGroup.get("congregation").value&&i.append("speakerCongId",this.secondFormGroup.get("congregation").value?.congId),this.secondFormGroup.get("speakerName").value&&i.append("speakerName",this.secondFormGroup.get("speakerName").value),this.secondFormGroup.get("outlineNo").value&&i.append("outlineNo",this.secondFormGroup.get("outlineNo").value?.outlineNo),this.secondFormGroup.get("songNo").value&&i.append("songNo",this.secondFormGroup.get("songNo").value)}this.uploadProgress=0,this.savinginProgress=!1,this.overAllStepperStatus.completed=!0,this.overAllStepperStatus.editable=!1;let l=!1;this._meetingService.Upload(i).pipe((0,ne.x)(()=>{this.uploadProgress=0,this.savinginProgress=!1,this.isSubmitting=!1,this.showStepper=l})).subscribe(a=>{if(a.type==k.dt.UploadProgress){const d=Math.round(a.loaded/a.total*100);this.uploadProgress=d,d>=100&&(this.savinginProgress=!0)}},a=>{l=!0,this.alert={type:"error",message:a.error.data},this.showAlert=!0,this.isSubmitting=!1,this.overAllStepperStatus.completed=!0,this.overAllStepperStatus.editable=!0})}uploadFiles(){var t=this;this.showAlert=!1,this.isSubmitting=!0,this.firstFormGroup.disable(),this.secondFormGroup.disable(),this.mediaArrangmentFormGroup.disable(),this.submitFormGroup.disable();let i={};const o=this.weekSelection.find(l=>l.weekNum==this.firstFormGroup.get("weekNumber").value).yearNumber;if(i.weekNumber=this.firstFormGroup.get("weekNumber").value,i.yearNumber=o,i.isMidWeek=this.isMidWeek,"true"!==this.isMidWeek){if(this.secondFormGroup.get("talkDate").value){const l=p().utc(this.secondFormGroup.get("talkDate").value).toString();i.talkDate=l}this.secondFormGroup.get("congregation").value&&(i.speakerCongId=this.secondFormGroup.get("congregation").value?.congId),this.secondFormGroup.get("speakerName").value&&(i.speakerName=this.secondFormGroup.get("speakerName").value),this.secondFormGroup.get("outlineNo").value&&(i.outlineNo=this.secondFormGroup.get("outlineNo").value?.outlineNo),this.secondFormGroup.get("songNo").value&&(i.songNo=this.secondFormGroup.get("songNo").value)}this._meetingService.SaveMeetingInfo(i).subscribe(function(){var l=h(function*(s){let a=s?.data?._id;yield t.uploadFilesRoundRobin(a),t.isSubmitting=!1});return function(s){return l.apply(this,arguments)}}())}uploadFilesRoundRobin(t){var i=this;return h(function*(){const s=new Map,a=new Map,d=new Map;let x=0,v=0;const _=[...i.selectedFiles];for(i.savinginProgress=!1,i.uploadProgress=0;_.length>0;){const g=_.splice(0,5-v);v+=g.length;const w=[];for(const m of g){const M=m?.fileId,U=m?.file,Dt=Math.ceil((U?.size??10485760)/10485760);s.set(m?.fileId,U?.size??0);const $=Math.max(Dt,1);for(let A=0;A<$;A++){const X=10485760*A,Ot=Math.min(X+10485760,U?.size),Yt=U?.slice(X,Ot),f=new FormData;f.append("isNew",(!m.isFromStorage).toString()),f.append("isExternalFile",m?.isExternalFile),f.append("externalFileInfoJSON",1==m?.isExternalFile?JSON.stringify(m?.additionalData):null),f.append("isPresaved",m.isPresaved),f.append("updateAction",m.updateAction||null),f.append("meetingId",t),f.append("fileId",M),f.append("name",m?.name),f.append("file",Yt),f.append("orderNo",m?.order),f.append("remarks",""),f.append("mimeType",U?.type),f.append("chunkNumber",A.toString()),f.append("totalChunks",$.toString());const Wt=oe(i._meetingService.UploadFile(f).pipe((0,C.U)(F=>{if(F.type===k.dt.UploadProgress){const ee=(d.get(M)||0)+F.loaded;d.set(M,ee),x+=F.loaded;const zt=s.get(M)||1,te=Math.round(100*ee/zt);a.set(M,te),m.uploadProgress=te;const jt=i.selectedFiles.reduce((Et,Lt)=>Et+Lt.size,0);i.uploadProgress=Math.min(Math.round(100*x/jt),100),i.uploadProgress>=100&&(i.savinginProgress=!0)}return F instanceof k.Zn&&201===F.status&&(v--,m.isSaved=!0,m.uploadProgress=100),F instanceof k.ZM&&400===F.status&&(v--,m.isSaved=!0,m.isError=!0,m.uploadProgress=100),F},F=>{v--,m.isSaved=!0,m.isError=!0,m.uploadProgress=100})));w.push(Wt)}}yield Promise.all(w)}i.uploadProgress=0,i.savinginProgress=!0,i.isSubmitting=!1,i.showStepper=!1})()}checkPTInformation(){var t=this;return h(function*(){if(t.meetingCheckString="Checking meeting information...","true"===t.isMidWeek)return void t.checkMeetingMedia();const i=t.weekSelection.find(l=>l.weekNum==t.firstFormGroup.get("weekNumber").value);"true"!==t.isMidWeek&&(t.minTalkDate=p()(p()(i.weekStart).startOf("day")).local().startOf("day"),t.maxTalkDate=p()(p()(i.weekEnd).startOf("day")).local().startOf("day"));let o=[{field:"yearNumber",value:i.yearNumber},{field:"weekNumber",value:t.firstFormGroup.get("weekNumber").value},{field:"isMidWeek",value:t.isMidWeek}];t.isMeetingInformationChecking=!0,t._meetingService.GetMeetingInformation(o).subscribe(function(){var l=h(function*(s){t.showAlert=!1;const a=s?.info??null;t.isPTEdit=!!a,t.canSelectOutline=!t.isPTEdit,t.canSelectCongregation=!t.isPTEdit,a?(t.secondFormGroup.get("congregation").setValue(t.congregationSelection.find(d=>d?.congId==a?.Depot?._id)),t.secondFormGroup.get("speakerName").setValue(a?.speakerName),t.secondFormGroup.get("outlineNo").setValue(t.outlineSelection.find(d=>d?.outlineNo==a?.outlineNo)),t.secondFormGroup.get("songNo").setValue(a?.songNo),t.secondFormGroup.get("talkDate").setValue(a?.talkDate?p()(a?.talkDate).local():null)):t.secondFormGroup.reset(),t.isMeetingInformationChecking=!1,t.firstFormGroup.get("valid").setValue(!0),t._meetingStepper.next()});return function(s){return l.apply(this,arguments)}}(),l=>{t.isPTEdit=!1,t.canSelectOutline=!0,t.canSelectCongregation=!0,t.secondFormGroup.reset(),t.isMeetingInformationChecking=!1,t.firstFormGroup.get("valid").setValue(!0),t._meetingStepper.next()})})()}checkOutlineMedia(){var t=this;return h(function*(){if(t.isOutlineMediaLoaded=!1,t.meetingPulledMedia.length>0)return t.isOutlineMediaChecking=!1,void t._meetingStepper.next();t.outlineMediaCheckString="Checking for outline media...";let i=[{field:"outlineNo",value:t.secondFormGroup.get("outlineNo").value?.outlineNo}];t.isOutlineMediaChecking=!0,t._meetingService.GetOutlineMedia(i).subscribe(function(){var o=h(function*(l){l?.media?.length>0?t._matDialog.open(W.$,{maxWidth:"400px",data:{title:"Cancel",message:"There are associated multimedia with the selected outline, would you like to load them?"}}).afterClosed().subscribe(function(){var a=h(function*(d){t.isOutlineMediaLoaded=d,1==d?(t.outlineMediaCheckString="Loading outline media...",t.removeAllFiles(),t.isThumbnailLoading=!0,yield new Promise(function(){var x=h(function*(v,_){for(let g of l?.media)try{if(!g?.storageThumbUrl)continue;const w=yield L(t._meetingService.GetThumbnail(g?.storageThumbUrl)),m=yield t.createImageFromBlob(w);t.selectedFiles.push({name:`Outline Image ${g?.orderNo}`,url:m,order:g.orderNo,fileId:g.storageFileId,isPresaved:!0,file:null,size:g?.size}),t.currentOrder=g?.orderNo,t.mediaArrangmentFormGroup.get("valid").setValue("true")}catch(w){t.showAlert=!0,t.alert.message=w?.message,t.alert.type="error"}v(),t.isOutlineMediaChecking=!1,t._meetingStepper.next()});return function(v,_){return x.apply(this,arguments)}}()),t.isThumbnailLoading=!1):(t.isOutlineMediaChecking=!1,t._meetingStepper.next())});return function(d){return a.apply(this,arguments)}}()):(t.isOutlineMediaChecking=!1,t._meetingStepper.next())});return function(l){return o.apply(this,arguments)}}())})()}checkMeetingMedia(){var t=this;return h(function*(){if(t.meetingPulledMedia=[],t.outlineMediaCheckString="Checking meeting media...",t.isOutlineMediaLoaded=!1,t.isOutlineMediaChecking=!0,t.totalFilesSize>0)return t.firstFormGroup.get("valid").setValue(!0),t._meetingStepper.next(),void(t.isOutlineMediaChecking=!1);"true"==t.isMidWeek&&t.submitFormGroup.get("valid").setValue(null),t.removeAllFiles();const i=t.weekSelection.find(l=>l.weekNum==t.firstFormGroup.get("weekNumber").value);"true"!==t.isMidWeek&&(t.minTalkDate=p()(p()(i.weekStart).startOf("day")).local().startOf("day"),t.maxTalkDate=p()(p()(i.weekEnd).startOf("day")).local().startOf("day"));let o=[{field:"yearNumber",value:i.yearNumber},{field:"weekNumber",value:t.firstFormGroup.get("weekNumber").value},{field:"isMidWeek",value:t.isMidWeek}];t._meetingService.GetMedia(o).subscribe(function(){var l=h(function*(s){t.showAlert=!1;const a=s.medias||[];if(t.meetingPulledMedia=a,t.meetingPulledMedia.length>0)t.isThumbnailLoading=!0,t.outlineMediaCheckString="Loading meeting media...","true"===t.isMidWeek&&(t.isMeetingInformationChecking=!0,t.meetingCheckString="Loading meeting media..."),yield new Promise(function(){var d=h(function*(x,v){for(let _ of a)try{let g=null,w=null;_?.isExternalFile||(g=yield L(t._meetingService.GetThumbnail(_.thumbnailUrl)),w=yield t.createImageFromBlob(g)),t.selectedFiles.push({isExternalFile:_?.isExternalFile,isNew:!1,name:_?.fileName,file:null,isFromStorage:!0,size:_?.fileSize,url:_?.isExternalFile?_?.thumbnailUrl:w,order:_.orderNo,fileId:_._id})}catch(g){t.showAlert=!0,t.alert.message=g?.message,t.alert.type="error"}x()});return function(x,v){return d.apply(this,arguments)}}()),t.isThumbnailLoading=!1,t.mediaArrangmentFormGroup.get("valid").setValue("true"),t.submitFormGroup.get("valid").setValue("true");else if("true"!==t.isMidWeek)return void t.checkOutlineMedia();t.sortBy("order"),t.currentOrder=a.length,t.isOutlineMediaChecking=!1,"true"===t.isMidWeek&&(t.isMeetingInformationChecking=!1),t.firstFormGroup.get("valid").setValue(!0),t._meetingStepper.next()});return function(s){return l.apply(this,arguments)}}(),l=>{t.isOutlineMediaChecking=!1,"true"===t.isMidWeek&&(t.isMeetingInformationChecking=!1),t.firstFormGroup.get("valid").setValue(!0),t._meetingStepper.next()})})()}deletePTEntry(){this._matDialog.open(W.$,{maxWidth:"400px",data:{title:"Cancel",message:"Are you sure you want to delete this entry?"}}).afterClosed().subscribe(i=>{if(1==i){this.secondFormGroup.reset();let l={yearNumber:this.weekSelection.find(s=>s.weekNum==this.firstFormGroup.get("weekNumber").value).yearNumber,weekNumber:this.firstFormGroup.get("weekNumber").value,isMidWeek:this.isMidWeek};this._meetingService.DeleteMeeting(l).subscribe(s=>{this.showStepper=!1,this.isSubmitting=!1,this.overAllStepperStatus.completed=!0,this.overAllStepperStatus.editable=!0})}})}onFileSelected(t){isNaN(this.totalFilesSize)&&(this.totalFilesSize=0);for(const i of t.target.files)this.generateThumbnailWithSize(i).then(({thumbnailDataUrl:o,fileSize:l})=>{this.totalFilesSize+=l,this.currentOrder+=1,this.selectedFiles.push({isNew:!0,fileId:this.generateFileId(),name:i.name,file:i,url:o,order:this.currentOrder,size:l,uploadProgress:0,isSaved:!1,isFromStorage:!1}),this.calculateFileSize()}).catch(o=>{console.error("Error generating thumbnail:",o)});this.mediaArrangmentFormGroup.get("valid").setValue("true"),t.target.value=null}calculateFileSize(){isNaN(this.totalFilesSize)&&(this.totalFilesSize=0);let t="KB",i=0,o=this.totalFilesSize/1024;o/1024>1?(i=o/1024,this.totalFilesLimitReached=this.totalFilesSize>this.totalFilesLimit,this.totalFilesLimitReached?this.submitFormGroup.get("valid").setValue(null):this.submitFormGroup.get("valid").setValue(!0),t="MB"):(this.submitFormGroup.get("valid").setValue(!0),this.totalFilesLimitReached=!1,i=o,t="KB"),this.totalFilesSizeString=`${(i||0).toFixed(2)} ${t}`}setFileOrder(t){if(null!=t){if(null==t.order){if(this.currentOrder+=1,t.order=this.currentOrder,!1===t.isNew){const i=this.selectedFiles.find(o=>o.fileId==t.fileId);i.order=t.order,i.updateAction="updated"}}else t.order==this.currentOrder&&(this.currentOrder-=1,t.order=null);this.sortBy("order"),this.currentOrder==this.cleanse(this.selectedFiles).length?this.mediaArrangmentFormGroup.get("valid").setValue("true"):this.mediaArrangmentFormGroup.get("valid").setValue(null)}}removeFile(t){!1===t.isNew?this.selectedFiles.find(i=>i==t).updateAction="deleted":(this.totalFilesSize-=t.size,this.selectedFiles.splice(this.selectedFiles.indexOf(t),1)),this.removeOrdering(),this.calculateFileSize(),"true"==this.isMidWeek&&this.selectedFiles.length<=0&&this.submitFormGroup.get("valid").setValue(null)}cleanse(t){return t.filter(i=>"deleted"!=(i.updateAction||""))}removeAllFiles(t=!1){t?this.selectedFiles.forEach(i=>{!1===i.isNew?this.selectedFiles.find(o=>o==i).updateAction="deleted":this.selectedFiles.splice(0,this.selectedFiles.length),this.totalFilesSize-=i.size}):this.selectedFiles.splice(0,this.selectedFiles.length),this.currentOrder=0,this.totalFilesSize=0,this.calculateFileSize(),"true"==this.isMidWeek&&this.selectedFiles.length<=0&&this.submitFormGroup.get("valid").setValue(null)}removeOrdering(){this.currentOrder=0,this.selectedFiles.forEach(t=>{t.order=null})}sortBy(t){return this.selectedFiles.sort((i,o)=>(null!=i[t]?i[t]:1/0)-(null!=o[t]?o[t]:1/0))}showNewFiles(t){return t.filter(i=>""===(i.updateAction||"")&&1==i.isNew)}GetWeeks(){var t;let i=[];for(t=-1;t<3;t++){const o=p()().add(t,"week").startOf("isoWeek"),l=p()().add(t,"week").endOf("isoWeek"),s=o.format("MM")==l.format("MM"),a=`${o.format("MMM DD")} - ${l.format(s?"DD, YYYY":"MMM DD, YYYY")}`,d=p()().add(t,"week").startOf("isoWeek").week();i.push({weekName:a,weekNum:d,weekStart:o,weekEnd:l})}return i}backToForms(){this.removeAllFiles(),this.selectedFiles=[],this.firstFormGroup.reset(),this.secondFormGroup.reset(),this.mediaArrangmentFormGroup.reset(),this.submitFormGroup.reset(),this.firstFormGroup.enable(),this.secondFormGroup.enable(),this.mediaArrangmentFormGroup.enable(),this.submitFormGroup.enable(),this.overAllStepperStatus.completed=!1,this.overAllStepperStatus.editable=!0,this._meetingStepper.reset(),this.showStepper=!0}createImageFromBlob(t){return new Promise((i,o)=>{let l=new FileReader;l.addEventListener("load",()=>{i(l.result)},!1),t&&l.readAsDataURL(t)})}generateThumbnailWithSize(t){return h(function*(){let i=URL.createObjectURL(t);if(i.startsWith("blob:")){const o=yield fetch(i).then(s=>s.blob()),l=o.type;if(l.startsWith("image/"))return new Promise(s=>{const a=new FileReader;a.onload=()=>{s({thumbnailDataUrl:a.result,fileSize:o.size})},a.readAsDataURL(o)});if(l.startsWith("video/")){const s=document.createElement("video"),a=document.createElement("canvas");return s.style.display="none",a.style.display="none",yield new Promise(x=>{s.addEventListener("loadedmetadata",()=>{s.width=s.videoWidth,s.height=s.videoHeight,a.width=s.videoWidth,a.height=s.videoHeight,s.currentTime=.2*s.duration}),s.addEventListener("seeked",()=>x()),s.src=i}),a.getContext("2d").drawImage(s,0,0,s.videoWidth,s.videoHeight),{thumbnailDataUrl:a.toDataURL("image/png"),fileSize:o.size}}}throw new Error("Unsupported file type")})()}parseTimeToSeconds(t){const i=t.split(":");return 3600*(parseInt(i[0],10)||0)+60*(parseInt(i[1],10)||0)+(parseInt(i[2],10)||0)}_filterOutlines(t){const i=t.toLowerCase();return this.outlineSelection.filter(o=>o?.title.toLowerCase().includes(i))}_filterCongregations(t){const i=t.toLowerCase();return this.congregationSelection.filter(o=>o?.name.toLowerCase().includes(i))}displayOutlineFn(t){return t?.title}displayCongFn(t){return t?.name}outlineSelectionClosed(){(this.secondFormGroup.get("outlineNo").value.outlineNo??-1)<0&&this.secondFormGroup.get("outlineNo").setErrors({error:!0})}congregationSelectionClosed(){const t=this.secondFormGroup.get("congregation").value?.congId??this.secondFormGroup.get("congregation").value,i=this.secondFormGroup.get("congregation").value;!t&&i&&this.secondFormGroup.get("congregation").setErrors({error:!0})}outlineColorCoding(t){if(t.lastUsed&&this.secondFormGroup.get("talkDate").value){if(p()(this.secondFormGroup.get("talkDate").value)>=p()(t?.lastUsed))return{"bg-red-200":!0};if(p()(this.secondFormGroup.get("talkDate").value)<=p()(t?.lastUsed))return{"bg-green-200":!0}}}generateFileId(){return"file_"+Date.now()}getWindowWidth(){return this.windowWidth-100+"px !important"}openUploadFromWebUrl(){this._matDialog.open(_e,{maxWidth:"400px"}).afterClosed().subscribe(i=>{i&&(this.selectedFiles.push({isExternalFile:!0,fileId:this.generateFileId(),isNew:!0,url:i?.poster,name:i?.title,order:null,size:null,additionalData:i}),this.submitFormGroup.get("valid").setValue(!0))})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(I.gz),e.Y36(S.on),e.Y36(V.D),e.Y36(c.QS))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-media"]],viewQuery:function(t,i){if(1&t&&e.Gf(be,5),2&t){let o;e.iGM(o=e.CRH())&&(i._meetingStepper=o.first)}},hostBindings:function(t,i){1&t&&e.NdJ("resize",function(l){return i.onWindowResize(l)},!1,e.Jf7)},decls:88,vars:52,consts:[[1,"flex","flex-col","items-center","justify-center","flex-auto","md:p-4"],[1,"flex","items-center","justify-end","w-full","sm:w-auto","max-w-[1000px]"],[1,"w-full","p-2","sm:mx-0"],["class","w-full h-150 max-h-150 flex flex-col items-center justify-center p-6",4,"ngIf"],[1,"w-full","h-150","max-h-150",3,"hidden"],[1,"flex","flex-row","flex-auto","space-x-1","items-center","justify-center","mt-2","mb-4","text-2xl","font-semibold","tracking-tight","leading-tight"],[1,"font-extrabold"],[1,"flex","flex-col","items-center","justify-center","mt-2","font-medium"],[1,"text-center"],["class","mt-2 mb-2",3,"appearance","showIcon","type",4,"ngIf"],["orientation","vertical",1,"w-full","bg-transparent",3,"linear"],["meetingStepper",""],[3,"stepControl","completed","editable"],[3,"formGroup"],["matStepLabel",""],["appearance","fill",1,"w-full","mt-4"],["matInput","","placeholder","Week number","formControlName","weekNumber","required","",3,"valueChange"],[4,"ngFor","ngForOf"],["mat-icon-button","","type","button","matSuffix","",3,"click"],[1,"icon-size-5",3,"svgIcon"],[3,"click",4,"ngIf"],[1,"flex","flex-row","justify-center"],["required","","formControlName","isMidweek",3,"ngModel","ngModelChange","change"],["value","true",1,"mr-6"],["value","false",1,"mr-6"],[1,"mt-4","flex","flex-col","justify-center"],[1,"flex","flex-row","items-end","justify-end"],[1,"flex","flex-col","justify-center"],["mat-flat-button","",3,"ngClass","color","disabled","click"],[4,"ngIf"],["class","flex flex-col justify-center",4,"ngIf"],[3,"stepControl","completed","editable",4,"ngIf"],[1,"h-full","w-full",3,"stepControl","completed","editable"],["hidden","","multiple","","type","file","accept","image/jpeg,image,png,image,jpg,video/*",3,"change"],["selectFile",""],["class","flex flex-col m-2 justify-center",4,"ngIf"],[1,"flex","flex","justify-between"],["class","relative",4,"ngIf"],[1,"mt-2","grid","md:grid-cols-4","md:gap-4","gap-3","grid-cols-3"],["fileUploadMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"md:icon-size-6","icon-size-5",3,"svgIcon"],["class","mt-4 flex flex-row justify-center",4,"ngIf"],["class","mt-8 flex flex-row justify-center",4,"ngIf"],["class","mt-2 flex flex-row justify-center",4,"ngIf"],[1,"mt-6","flex","flex-row","items-end","justify-end"],["mat-button","","matStepperPrevious","",3,"color"],["mat-flat-button","","matStepperNext","",3,"color","disabled"],["class","h-full",3,"stepControl","completed","editable",4,"ngIf"],[1,"w-full",3,"stepControl"],[1,"relative","flex","flex-col","left-0","z-49","mt-2"],["class"," mt-2",4,"ngIf"],[1,"flex","flex-row","items-end","justify-end","mt-4"],["mat-button","","matStepperPrevious","",3,"color","disabled"],["mat-flat-button","",3,"color","disabled","click"],[3,"diameter","mode",4,"ngIf"],[1,"w-full","h-150","max-h-150","flex","flex-col","items-center","justify-center","p-6"],[1,"flex","flex-row","flex-auto","space-x-1","items-center","justify-center","mt-6","font-semibold","tracking-tight","leading-tight"],[1,"text-[16px]"],[1,"text-[12px]","font-semibold","mt-4","text-center"],[1,"icon-size-16","text-green-500","mt-2",3,"svgIcon"],[1,"text-md","font-semibold","mt-4","text-center","text-blue-600","cursor-pointer",3,"click"],[1,"mt-2","mb-2",3,"appearance","showIcon","type"],[3,"value"],[3,"click"],["class","absolute inline-flex animate-ping text-white",4,"ngIf"],[1,"relative","inline-flex","text-white"],[1,"absolute","inline-flex","animate-ping","text-white"],[1,"flex","flex-row","space-x-[5px]"],[1,"text-sm","mt-[5px]"],[3,"diameter","mode"],["appearance","fill",1,"w-full","mt-2"],["matInput","","autocomplete","off","autocomplete","disabled","placeholder","Talk Date","formControlName","talkDate",3,"max","min","matDatepicker","click"],["matSuffix","",3,"for"],["startView","month"],["talkDatePicker",""],["matInput","","placeholder","Select congregation from the list","formControlName","congregation",3,"readonly","matAutocomplete"],["autoActiveFirstOption","",3,"displayWith","optionSelected","closed"],["auto","matAutocomplete"],[1,"text-gray-400"],["required","","matInput","","placeholder","Speaker Name","formControlName","speakerName","required",""],["required","","matInput","","placeholder","Select outline from the list","formControlName","outlineNo","required","",3,"readonly","matAutocomplete"],["outlineAutocomplete","matAutocomplete"],["required","","matInput","","placeholder","Song number","type","number","pattern","[0-9]*","inputmode","numeric","formControlName","songNo","required",""],[1,"flex","justify-between"],[1,"flex","flex-row","items-start","justify-start"],["mat-flat-button","",3,"color","disabled","click",4,"ngIf"],["mat-flat-button","",3,"disabled","ngClass","color","click"],[3,"value","ngClass"],[1,"flex","flex-col","m-2","justify-center"],[1,"text-center","text-lg","font-medium"],[1,"text-red-700"],[1,"text-center","mt-2","text-gray-500","text-md","font-semibold"],[1,"rounded-lg","p-2","bg-cyan-500"],[1,"text-[14px]","font-semibold","text-white"],[1,"relative"],[1,"rounded-lg","p-2",3,"ngClass"],[1,"text-[14px]","font-bold","text-white"],[1,"flex","flex-col","justify-center","bg-black","relative","border-2","border-cyan-500"],[1,""],[1,"",3,"src"],[1,"absolute","top-0","right-0","w-full","h-full"],[1,"flex","justify-between","bg-black/[0.6]"],[1,"md:icon-size-6","icon-size-5","text-red-600",3,"svgIcon"],[1,"mt-4","flex","flex-row","justify-center"],[1,"text-[12px]","font-semibold","text-gray-600"],[1,"bg-blue-700","hover:bg-blue-500","hover:shadow-xl","shadow-lg","text-white","rounded-lg","p-2","cursor-pointer",3,"matMenuTriggerFor"],[1,"mt-[8px]","text-[10px]","font-semibold","text-gray-600"],[1,"text-red-400"],[1,"mt-8","flex","flex-row","justify-center"],[1,"text-[12px]","font-semibold","text-red-600"],[1,"flex","flex-col","justify-center","w-[150px]","h-[30px]","rounded-xl","shadow-lg","cursor-pointer",3,"disabled","ngClass","matMenuTriggerFor"],[1,"text-white","text-md","text-center","w-full"],[1,"mt-2","flex","flex-row","justify-center"],[1,"flex","flex-col","justify-center","w-[150px]","h-[30px]","hover:bg-red-500","rounded-xl","bg-red-700","shadow-lg","hover:shadow-xl","cursor-pointer",3,"click"],[1,"text-white","text-md","text-center"],[1,"h-full",3,"stepControl","completed","editable"],[1,"flex","flex-col","space-y-[10px]"],[1,"flex","flex-col","justify-center","w-full"],[1,"text-[14px]","font-semibold","text-center"],["class","text-[12px] font-medium text-center",4,"ngIf"],["mat-button","",1,"w-[100px]",3,"color","click"],[1,"text-red"],[1,"grid","md:grid-cols-4","md:gap-4","gap-3","grid-cols-3"],["mat-flat-button","","matStepperNext","",3,"color","disabled","click"],[1,"text-[12px]","font-medium","text-center"],[1,"absolute","top-0","right-0","w-full","h-full","hover:bg-black/[0.3]","cursor-pointer",3,"ngClass","click"],["class","flex flex-col justify-center w-full h-full",4,"ngIf"],[1,"flex","flex-col","justify-center","w-full","h-full"],[1,"md:w-10","md:h-10","md:text-4xl","text-xl","w-5","h-5","font-semibold","text-center","text-white"],[1,"text-start","font-semibold","text-lg"],[1,"text-start","font-medium","text-md","mt-2","break-words","whitespace-pre-line"],[1,"text-red-400","text-md"],[1,"text-blue-400","text-md"],[1,"text-start","font-medium","text-md","mt-4","break-words","whitespace-pre-line","text-red-600"],[1,"p-[5px]","text-white","bg-red-500","font-semibold"],["class","mt-2 text-start font-medium text-md break-words whitespace-pre-line text-green-500",4,"ngIf"],["class","mt-2 w-full h-[10px]",3,"value","mode",4,"ngIf"],["class","mt-2 w-full h-[10px]",3,"mode",4,"ngIf"],[1,"mt-2","text-start","font-medium","text-md","break-words","whitespace-pre-line","text-green-500"],[1,"mt-2","w-full","h-[10px]",3,"value","mode"],[1,"mt-2","w-full","h-[10px]",3,"mode"],[1,"mt-2"],[1,"text-start","font-medium","text-md","break-words","whitespace-pre-line"],[1,"fuseScrollbar","overflow-auto","max-h-[250px]","pb-6"],[1,"flex","flex-col","m-2"],[1,"flex","flex-row","bg-white","shadow-lg","h-[90px]"],[1,"flex","flex-row"],[1,"w-[8px]","rounded-l-2xl","h-full",3,"ngClass"],[1,"max-w-[130px]","min-w-[130px]","h-full","rounded-l-2xl","p-2"],[1,"h-[60px]","w-[120px]",3,"src"],[1,"w-full","h-full","flex","flex-col","p-4","bg-white","min-w-[400px]"],[1,"flex","flex-row","justify-start"],[1,"flex","flex-col"],[1,"md:font-bold","md:text-lg","font-semibold","text-md","truncate"],[1,"font-medium","text-sm"],[1,"w-full","flex","flex-row","justify-start"],["class","mt-2 w-full h-[4px]",3,"value","mode",4,"ngIf"],[1,"mt-2","w-full","h-[4px]",3,"value","mode"],[1,"flex","flex-row","items-center"],[1,"text-sm","font-bold","ml-2"],["class","flex flex-row items-center",4,"ngIf"],[1,"text-green-500",3,"svgIcon"],[1,"text-red-500",3,"svgIcon"]],template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,we,12,2,"div",3),e.TgZ(4,"div",4)(5,"div",5)(6,"span"),e._uU(7,"Greetings "),e.TgZ(8,"span",6),e._uU(9),e.qZA(),e._uU(10,"!"),e.qZA()(),e.TgZ(11,"div",7)(12,"div",8),e._uU(13,"Please fill the following meeting information."),e.qZA()(),e.YNc(14,Fe,2,5,"fuse-alert",9),e.TgZ(15,"mat-stepper",10,11)(17,"mat-step",12)(18,"form",13),e.YNc(19,ke,1,0,"ng-template",14),e.TgZ(20,"mat-form-field",15)(21,"mat-label"),e._uU(22,"Meeting Week"),e.qZA(),e.TgZ(23,"mat-select",16),e.NdJ("valueChange",function(){return i.meetingWeekChanged()}),e.YNc(24,Ze,3,2,"ng-container",17),e.qZA(),e.TgZ(25,"button",18),e.NdJ("click",function(){return i.firstFormGroup.get("weekNumber").setValue("")}),e._UZ(26,"mat-icon",19),e.qZA(),e.TgZ(27,"mat-error"),e._uU(28," Meeting week is required. "),e.qZA()(),e.YNc(29,Te,2,0,"button",20),e.TgZ(30,"div",21)(31,"mat-radio-group",22),e.NdJ("ngModelChange",function(s){return i.isMidWeek=s})("change",function(){return i.meetingWeekChanged()}),e.TgZ(32,"mat-radio-button",23),e._uU(33,"Midweek"),e.qZA(),e.TgZ(34,"mat-radio-button",24),e._uU(35,"Weekend"),e.qZA()()(),e.TgZ(36,"div",25)(37,"div",26),e._UZ(38,"div",27),e.TgZ(39,"button",28),e.NdJ("click",function(){return i.checkPTInformation()}),e.YNc(40,Me,4,1,"div",29),e.YNc(41,Ue,5,3,"div",30),e.qZA()()()()(),e.YNc(42,De,66,35,"mat-step",31),e.TgZ(43,"mat-step",32),e.YNc(44,Oe,1,0,"ng-template",14),e.TgZ(45,"div",27)(46,"input",33,34),e.NdJ("change",function(s){return i.onFileSelected(s)}),e.qZA(),e.TgZ(48,"div",25),e.YNc(49,Ye,7,0,"div",35),e.TgZ(50,"div",36),e.YNc(51,Pe,4,1,"div",29),e.YNc(52,ze,5,7,"div",37),e.qZA()(),e.TgZ(53,"div",38),e.YNc(54,je,8,2,"ng-container",17),e.qZA(),e.TgZ(55,"mat-menu",null,39)(57,"button",40),e.NdJ("click",function(){return i.openUploadFromWebUrl()}),e._UZ(58,"mat-icon",41),e.TgZ(59,"span"),e._uU(60,"From a web url"),e.qZA()(),e.TgZ(61,"button",40),e.NdJ("click",function(){e.CHM(o);const s=e.MAs(47);return e.KtG(s.click())}),e._UZ(62,"mat-icon",41),e.TgZ(63,"span"),e._uU(64,"Select from device"),e.qZA()()(),e.YNc(65,Ee,13,4,"div",42),e.YNc(66,Le,3,0,"div",43),e.YNc(67,Be,4,6,"div",42),e.YNc(68,Re,4,0,"div",44),e.qZA(),e.TgZ(69,"div",45)(70,"button",46),e._uU(71,"Back"),e.qZA(),e.TgZ(72,"button",47),e.YNc(73,Ke,4,2,"div",29),e.YNc(74,Xe,4,1,"div",29),e.qZA()()(),e.YNc(75,st,22,11,"mat-step",48),e.TgZ(76,"mat-step",49),e.YNc(77,at,1,0,"ng-template",14),e.TgZ(78,"div",50),e.YNc(79,ut,14,1,"ng-container",29),e.YNc(80,pt,15,4,"ng-container",29),e.YNc(81,wt,5,3,"div",51),e.qZA(),e.TgZ(82,"div",52)(83,"button",53),e._uU(84,"Back"),e.qZA(),e.TgZ(85,"button",54),e.NdJ("click",function(){return i.uploadFiles()}),e.YNc(86,Ft,5,0,"div",29),e.YNc(87,kt,1,2,"mat-progress-spinner",55),e.qZA()()()()()()()()}if(2&t){let o;e.xp6(3),e.Q6J("ngIf",!i.showStepper),e.xp6(1),e.Q6J("hidden",!i.showStepper),e.xp6(5),e.Oqu(null==i.userData?null:i.userData.nickname),e.xp6(5),e.Q6J("ngIf",i.showAlert),e.xp6(1),e.Q6J("linear",!0),e.xp6(2),e.Q6J("stepControl",i.firstFormGroup)("completed",i.stepperStatus.meetingInfoCompleted)("editable",i.overAllStepperStatus.editable),e.xp6(1),e.Q6J("formGroup",i.firstFormGroup),e.xp6(6),e.Q6J("ngForOf",i.weekSelection),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:x-circle"),e.xp6(3),e.Q6J("ngIf",!i.env.production),e.xp6(2),e.Q6J("ngModel",i.isMidWeek),e.xp6(8),e.Q6J("ngClass",e.VKq(50,K,i.isMeetingInformationChecking))("color","primary")("disabled",""==(i.firstFormGroup.get("weekNumber").value||"")||""==(i.firstFormGroup.get("isMidweek").value||"")||i.isMeetingInformationChecking),e.xp6(1),e.Q6J("ngIf",!i.isMeetingInformationChecking),e.xp6(1),e.Q6J("ngIf",i.isMeetingInformationChecking),e.xp6(1),e.Q6J("ngIf","false"==i.firstFormGroup.get("isMidweek").value),e.xp6(1),e.Q6J("stepControl",i.submitFormGroup)("completed",i.stepperStatus.mediaUploadCompleted)("editable",i.overAllStepperStatus.editable),e.xp6(6),e.Q6J("ngIf",i.isOutlineMediaLoaded),e.xp6(2),e.Q6J("ngIf",i.cleanse(i.selectedFiles).length>0),e.xp6(1),e.Q6J("ngIf",i.totalFilesSize>0),e.xp6(2),e.Q6J("ngForOf",i.cleanse(i.selectedFiles)),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:link"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:folder"),e.xp6(3),e.Q6J("ngIf",!i.isThumbnailLoading&&i.cleanse(i.selectedFiles).length<=0),e.xp6(1),e.Q6J("ngIf",i.totalFilesLimitReached),e.xp6(1),e.Q6J("ngIf",i.cleanse(i.selectedFiles).length>0),e.xp6(1),e.Q6J("ngIf",i.cleanse(i.selectedFiles).length>0),e.xp6(2),e.Q6J("color","warn"),e.xp6(2),e.Q6J("color","primary")("disabled",i.isSubmitting)("disabled",i.submitFormGroup.invalid||"true"==i.isMidWeek&&i.selectedFiles.length<=0),e.xp6(1),e.Q6J("ngIf","false"==i.isMidWeek),e.xp6(1),e.Q6J("ngIf","true"==i.isMidWeek),e.xp6(1),e.Q6J("ngIf",i.cleanse(i.selectedFiles).length>0),e.xp6(1),e.Q6J("stepControl",i.submitFormGroup),e.xp6(3),e.Q6J("ngIf",!i.isSubmitting),e.xp6(1),e.Q6J("ngIf",i.isSubmitting),e.xp6(1),e.Q6J("ngIf",(null==(o=i.showNewFiles(i.selectedFiles))?null:o.length)>0),e.xp6(2),e.Q6J("color","warn")("disabled",i.isSubmitting),e.xp6(2),e.Q6J("color","primary")("disabled",i.isSubmitting)("disabled",i.submitFormGroup.invalid),e.xp6(1),e.Q6J("ngIf",!i.isSubmitting),e.xp6(1),e.Q6J("ngIf",i.isSubmitting)}},dependencies:[Z.mk,Z.sg,Z.O5,J.eB,B.d,G.Hw,N.W0,N.tN,N.D8,R.eI,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.Q7,c.c5,c.sg,c.u,b.nI,b.v_,b.$V,b.nX,Q.k0,D.VN,D.QJ,he.CK,q.sN,xe.W,T.C0,T.VY,T.Vq,T.Ic,T.fd,y.Mq,y.hl,y.nW,H.x8,O.OY,O.vy,Z.Ov,ve]}),n})();var Tt=u(4128),Ct=u(8951);const Mt=[{path:"",data:{layout:"empty"},children:[{path:"media",data:{layout:"centered"},resolve:{UserData:(()=>{class n{constructor(t,i){this._httpClient=t,this._authService=i,this.apiHost=z.N.apiHost}resolve(t,i){return(0,Tt.D)([this._authService.handShake()]).pipe((0,C.U)(([o])=>({userInfo:o})))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(k.eN),e.LFG(Ct.e))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},component:Zt}]}];let Ut=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[I.Bz.forChild(Mt),I.Bz]}),n})();var St=u(8492),Nt=u(3314),yt=u(8927),At=u(5815),It=u(7469),Jt=u(6287),Gt=u(7775),Qt=u(4466);let qt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[Z.ez,Ut,J.yu,Nt.vV,B.t,G.Ps,N.jT,R.jc,Qt.m,b.wp,S.yj,Q.x4,It.Wd,yt.yD,D.D8,q.UK,Jt.y,Gt.fC,T.T5,y.FA,St.Yd,H.uw,O.Xo,At.N6]}),n})()}}]);